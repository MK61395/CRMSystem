<div class="container mt-4">
  <div class="card">
    <div class="card-header">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <h2 class="mb-0">Customer Management</h2>
        <div class="d-flex gap-2">
          <button class="btn btn-primary" (click)="showForm = !showForm">
            {{ showForm ? 'Hide Form' : 'Add Customer' }}
          </button>
          <button class="btn btn-success" (click)="exportToExcel()">
            <i class="bi bi-file-excel"></i> Export
          </button>
          <button class="btn btn-info" (click)="printList()">
            <i class="bi bi-printer"></i> Print
          </button>
        </div>
      </div>

      <!-- Search and Filter Section -->
      <div class="row g-3">
        <div class="col-md-4">
          <div class="input-group">
            <span class="input-group-text">
              <i class="bi bi-search"></i>
            </span>
            <input
              type="text"
              class="form-control"
              placeholder="Search customers..."
              [(ngModel)]="searchTerm"
              (input)="onSearch()"
            >
          </div>
        </div>
        <div class="col-md-8">
          <div class="d-flex gap-2">
            <select class="form-select w-auto" [(ngModel)]="sortColumn" (change)="onSort()">
              <option value="name">Sort by Name</option>
              <option value="email">Sort by Email</option>
              <option value="phoneNumber">Sort by Phone</option>
            </select>
            <button class="btn btn-outline-secondary" (click)="toggleSortDirection()">
              <i class="bi" [ngClass]="sortDirection === 'asc' ? 'bi-sort-up' : 'bi-sort-down'"></i>
            </button>
          </div>
        </div>
      </div>
    </div>
    
    <div class="card-body">
      <!-- Error Alert -->
      <div *ngIf="error" class="alert alert-danger alert-dismissible fade show" role="alert">
        {{ error }}
        <button type="button" class="btn-close" (click)="error = null"></button>
      </div>

      <!-- Customer Form -->
      <div *ngIf="showForm" class="mb-4">
        <form [formGroup]="customerForm" (ngSubmit)="onSubmit()" class="row g-3">
          <div class="col-md-4">
            <label for="name" class="form-label">Name</label>
            <input type="text" class="form-control" id="name" formControlName="name">
            <div *ngIf="customerForm.get('name')?.invalid && customerForm.get('name')?.touched" class="text-danger">
              Name is required (min 2 characters)
            </div>
          </div>
          
          <div class="col-md-4">
            <label for="email" class="form-label">Email</label>
            <input type="email" class="form-control" id="email" formControlName="email">
            <div *ngIf="customerForm.get('email')?.invalid && customerForm.get('email')?.touched" class="text-danger">
              Valid email is required
            </div>
          </div>
          
          <div class="col-md-4">
            <label for="phoneNumber" class="form-label">Phone Number</label>
            <input type="tel" class="form-control" id="phoneNumber" formControlName="phoneNumber">
            <div *ngIf="customerForm.get('phoneNumber')?.invalid && customerForm.get('phoneNumber')?.touched" class="text-danger">
              Valid phone number is required
            </div>
          </div>
          
          <div class="col-12">
            <button type="submit" class="btn btn-success me-2" [disabled]="!customerForm.valid">
              {{ editingCustomer ? 'Update' : 'Add' }} Customer
            </button>
            <button type="button" class="btn btn-secondary" (click)="resetForm()">Cancel</button>
          </div>
        </form>
      </div>

      <!-- Customer List -->
      <div class="table-responsive">
        <table class="table table-striped table-hover">
          <thead>
            <tr>
              <th>Name</th>
              <th>Email</th>
              <th>Phone Number</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngIf="loading">
              <td colspan="4" class="text-center">Loading...</td>
            </tr>
            <tr *ngFor="let customer of customers">
              <td>{{ customer.name }}</td>
              <td>{{ customer.email }}</td>
              <td>{{ customer.phoneNumber }}</td>
              <td>
                <button class="btn btn-sm btn-primary me-2" (click)="editCustomer(customer)">
                  Edit
                </button>
                <button class="btn btn-sm btn-danger" (click)="deleteCustomer(customer.id)">
                  Delete
                </button>
              </td>
            </tr>
            <tr *ngIf="!loading && customers.length === 0">
              <td colspan="4" class="text-center">No customers found</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Statistics Card -->
  <div class="card mt-4">
    <div class="card-header">
      <h3 class="mb-0">Customer Statistics</h3>
    </div>
    <div class="card-body">
      <div class="row">
        <div class="col-md-4">
          <div class="card bg-primary text-white">
            <div class="card-body">
              <h5 class="card-title">Total Customers</h5>
              <h2>{{ customers.length }}</h2>
            </div>
          </div>
        </div>
        <!-- Add more statistics cards here -->
      </div>
    </div>
  </div>
</div> 